# USB-Unblock-Tool

中文 | [English](README_EN.md)

**USB-Unblock-Tool** 是一个轻量级的 PowerShell 工具，用于解决 Windows 下"无法弹出 USB 存储设备"的问题。

它通过扫描 Windows 事件日志 (Kernel-PnP Event ID 225) 来精准定位占用外接设备的进程，让您可以安全地关闭或强制结束该进程。

## ✨ 功能特点

* **无需安装：** 纯 PowerShell 脚本，即下即用。
* **精准检测：** 基于系统底层事件 ID 225，准确找到占用者。
* **自动提权：** 自动获取管理员权限以读取日志。
* **进程管理：** 显示进程路径，支持一键结束进程。

## 🚀 使用方法

1.  **步骤 1：** 先尝试在右下角弹出 USB 设备，等待 Windows 提示"设备正在使用中"。
    > **注意：** 脚本依赖此报错记录来定位进程。

2.  **步骤 2：** 找到 `USB_Blocker_Detector.ps1` 文件，**鼠标右键点击**，选择 **"使用 PowerShell 运行"**。
    > **注意：** 直接双击可能会用记事本打开，所以请使用右键菜单。

3.  **步骤 3：** 脚本将显示阻止弹出的程序名称、PID 和文件路径。

4.  **步骤 4：** 如果需要，根据提示输入 `Y` 结束该进程。

## ❓ 常见问题

**问：脚本一闪而过或出现红字报错？**

**答：** 请以管理员身份打开 PowerShell 并尝试手动运行脚本，并确保脚本名称**不含任何中文字符或空格**。

## 🛠️ 环境要求

* Windows 10 / Windows 11
* PowerShell 5.1 或更高版本 (Windows 内置)

## ⚠️ 免责声明

本工具提供强制结束进程的功能。在结束任何程序之前，请确保已保存数据。作者不对因强制关闭进程导致的数据丢失负责。

---

### 📝 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件
